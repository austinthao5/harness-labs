apiVersion: apps/v1
kind: Deployment
metadata:
  name: simple-flask
  labels:
    app: simple-flask
spec:
  replicas: 1
  selector:
    matchLabels:
      app: simple-flask
  template:
    metadata:
      labels:
        app: simple-flask
    spec:
      containers:
        - name: flask-container
          image: austinthao/flask-app:v1
          readinessProbe:
            exec:
              command:
              - sh
              - -c
              - |
                # Wait 15 seconds before reporting ready
                if [ $(($(date +%s) - $(cat /tmp/start_time))) -gt 15 ]; then
                  exit 0
                else
                  exit 1
                fi
          ports:
            - containerPort: 80
